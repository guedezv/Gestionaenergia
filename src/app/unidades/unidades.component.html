<div class="layout">
  <app-header></app-header>

  <div class="layout-main">
    <div class="sidebar-container">
      <app-sidebar></app-sidebar>
    </div>

    <div class="container mt-4 unidades">
      <h2>Unidades</h2>

      <!-- Filtros -->
      <div class="filter-block">
        <label class="filter-label">Filtrar por:</label>
        <div class="filter-line">
          <input
            type="text"
            class="form-control"
            placeholder="Nombre"
            [(ngModel)]="filtroNombre"
          />
          <input
            type="text"
            class="form-control"
            placeholder="Dirección inmueble"
            [(ngModel)]="filtroDireccion"
          />
          <button class="btn btn-primary btn-filter" (click)="aplicarFiltro()">
            Filtrar
            <img src="/../icono-btn-filtrar.svg" alt="Icono de filtro" class="btn-icon" />
          </button>
        </div>
      </div>

      <!-- Encabezados -->
      <div class="header-row">
        <span class="col-left">Nombre</span>
        <span class="col-left">Ubicación</span>
        <span class="col-left" style="text-align:center;">Activo</span>
        <span class="col-right">Acciones</span>
      </div>
      <hr class="separator" />

      <!-- Tabla -->
<table class="table table-clean zebra">
        <tbody>
          <tr *ngFor="let d of direcciones">
            <td class="col-nombre">
              <div class="row-chip">{{ d.NombreUnidad }}</div>
            </td>

            <td class="col-ubicacion">
              <div class="row-chip">{{ d.Ubicacion }}</div>
            </td>

            <td class="col-activo" style="width:120px; text-align:center;">
              <div class="row-chip" style="display:flex; justify-content:center;">
                <input type="checkbox" [checked]="!!d.Active" disabled />
              </div>
            </td>

            <td class="col-acciones">
              <div class="row-chip-actions actions">
                <button class="btn btn-sm btn-edit" (click)="editar(d)">Editar</button>
                <button
                  class="btn btn-sm btn-delete"
                  [disabled]="eliminandoId === d.Id"
                  (click)="eliminar(d)">
                  Eliminar
                </button>
              </div>
            </td>
          </tr>

          <tr *ngIf="!cargando && !direcciones?.length">
            <td colspan="4" class="empty">No hay unidades para mostrar.</td>
          </tr>
        </tbody>
      </table>

      <div class="uni">
        <!-- Paginación -->
        <nav *ngIf="totalPaginas > 1" class="paginacion">
          <ul class="pagination">
            <li class="page-item" [class.disabled]="paginaActual === 1">
              <button class="page-link" (click)="cambiarPagina(paginaActual - 1)">&lt;</button>
            </li>

            <li
              class="page-item"
              *ngFor="let _ of [].constructor(totalPaginas); let i = index"
              [class.active]="paginaActual === (i + 1)">
              <button class="page-link" (click)="cambiarPagina(i + 1)">{{ i + 1 }}</button>
            </li>

            <li class="page-item" [class.disabled]="paginaActual === totalPaginas">
              <button class="page-link" (click)="cambiarPagina(paginaActual + 1)">&gt;</button>
            </li>
          </ul>
        </nav>

        <!-- Botones finales -->
        <div class="bottom-actions">
          <button class="btn btn-primary btn-create" (click)="crearNueva()">Crear nueva</button>
          <button class="btn btn-secondary" (click)="volver()">Volver</button>
        </div>
      </div>

      <div *ngIf="cargando" class="alert alert-info" style="margin-top:.75rem;">Cargando…</div>
      <div *ngIf="!cargando && error" class="alert alert-danger" style="margin-top:.75rem;">
        {{ error }}
      </div>
    </div>
  </div>

  <app-footer></app-footer>
</div>
